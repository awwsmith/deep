{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>DEEP</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Dosis:300,400,500,,600,700,700i|Lato:300,300i,400,400i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

  <!-- =======================================================
  * Template Name: Butterfly - v4.7.0
  * Template URL: https://bootstrapmade.com/butterfly-free-bootstrap-theme/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">

      <a href="{% url 'index' %}" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid">&nbsp DEEP</a>
      <!-- Uncomment below if you prefer to use text as a logo -->
      <!-- <h1 class="logo"><a href="index.html">Butterfly</a></h1> -->

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto" href="/">Search</a></li>
          <li><a class="nav-link scrollto" href="about.html">About</a></li>

        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->

  
  <main id="main">
<!-- ======= Search Section ======= -->
<section id="search" class="services section-bg">
  <div style="margin-top:80px;" class="container">

    

    <div class="row">
      <div class="col-lg-12 col-md-12">
        <div class="icon-box">
          <div class="icon"><i class="bi bi-search" style="color: #000cb3;"></i></div>
          
            <input onkeyup="search(this.value)" style="margin-left:10px; width:100%" type="text" name="search" placeholder="Search for a playbook...">
        
        </div>
      </div>
      
      
  </div>
  <div class="row">
    <div class="col-lg-4 col-md-6">
      <div class="icon-box">
        <div class="icon"><i class="bi bi-book-fill" style="color: #ff689b;"></i></div>
        <h4 class="title"><a href="">By Title</a></h4>
        <select id="titles" data-placeholder="Select title..." class="form-control select-access-multiple-enable">
      </select>
      </div>
    </div>

    <div class="col-lg-4 col-md-6">
      <div class="icon-box">
        <div class="icon"><i class="bi bi-person-lines-fill" style="color: #e9bf06;"></i></div>
        <h4 class="title"><a href="">By Author</a></h4>
        <select id="authors" data-placeholder="Select author..."  class="form-control select-access-multiple-enable">
        </div>
    </div>

    <div class="col-lg-4 col-md-6" data-wow-delay="0.1s">
      <div class="icon-box">
        <div class="icon"><i class="bi bi-chat-text" style="color: #3fcdc7;"></i></div>
        <h4 class="title"><a href="">By Company</a></h4>
        <select id="companies" data-placeholder="Select something"  class="form-control select-access-multiple-enable">
      </div>
    </div>

    <div class="col-lg-4 col-md-6" data-wow-delay="0.1s">
      <div class="icon-box">
        <div class="icon"><i class="bi bi-border-width" style="color:#41cf2e;"></i></div>
        <h4 class="title"><a href="">By Theater</a></h4>
        <select id="theaters" data-placeholder="Select theater..."  class="form-control select-access-multiple-enable">
      </div>
    </div>

    <!-- This is here so that the whole page displays, not sure why it does not work without it.  TODO fix this -->
    <div class="col-lg-4 col-md-6" data-wow-delay="0.1s">
      <div class="icon-box">
        <div class="icon"><i class="bi bi-border-width" style="color:#41cf2e;"></i></div>
        <h4 class="title"><a href="">By Theater1</a></h4>
        <select id="theaters" data-placeholder="Select theater..."  class="form-control select-access-multiple-enable">
      </div>
    </div>

    
  </div>

  <div class="row">
    <div class="col-lg-12 col-md-12">
      <div id="results"  class="icon-box">
        <div class="icon"><i class="bi bi-binoculars-fill" style="color: #000cb3;"></i></div>
        
        
      
      </div>
    </div>
    
</div>
</section><!-- End Search Section -->

  
    
    
    
    
    

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">

 
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://unpkg.com/lunr/lunr.js"></script>
 <script>
  
  $('#titles').select2({
  ajax: {
    url: "{% url 'title_autocomplete' %}",
    dataType: 'json'
    // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
  }
});
  
$('#authors').select2({
  ajax: {
    url: "{% static 'data/authors.json' %}",
    dataType: 'json'
    // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
  }
});
$('#theaters').select2({
  ajax: {
    url: "{% static 'data/theaters.json' %}",
    dataType: 'json'
    // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
  }
});
  </script>
  <!-- select2 JS File -->
 <script>
function htmlToElement(html) {
      var template = document.createElement("template");
      html = html.trim(); // Never return a text node of whitespace as the result
      template.innerHTML = html;
      return template.content.firstChild;
    }

let index;
$.getJSON("../assets/lunr/search.json", function(json) {
  index = lunr.Index.load(json);;
});

function search(query) {
  if (event.keyCode === 13) { 
    interview_results = index.search(query)
    console.log(interview_results);
    for (i in interview_results) {
      if (interview_results[i].score > 0) {
        document
            .querySelector("#results")
            .appendChild(
              htmlToElement(
                `<div id="${interview_results[i].ref}" style="border: 1px inset rgba(95,81,164,0.26);
                border-radius: 20px; padding:50px;">
                <h4 onclick="window.location.href='../interview/${interview_results[i].ref}.html'">${interview_results[i].ref}</h4>
                <ul></ul>
                </div>`
              )
            );

      }
      
    }

  }
}

 </script>
  
</body>

</html>